Only in hardware-monitor-0.7: config.h
Only in hardware-monitor-0.7: config.log
Only in hardware-monitor-0.7: config.status
Only in hardware-monitor-0.7: HardwareMonitor.server
Only in hardware-monitor-0.7: HardwareMonitor.server.in
Only in hardware-monitor-0.7/help/C: Makefile
Only in hardware-monitor-0.7/help: Makefile
Only in hardware-monitor-0.7: intltool-extract
Only in hardware-monitor-0.7: intltool-merge
Only in hardware-monitor-0.7: intltool-update
Only in hardware-monitor-0.7: Makefile
Only in hardware-monitor-0.7/po: .intltool-merge-cache
Only in hardware-monitor-0.7/po: Makefile
Only in hardware-monitor-0.7/po: Makefile.in
Only in hardware-monitor-0.7/po: POTFILES
diff --context --recursive hardware-monitor-0.7-orig/src/curve-view.cpp hardware-monitor-0.7/src/curve-view.cpp
*** hardware-monitor-0.7-orig/src/curve-view.cpp	2003-08-25 08:56:55.000000000 -0700
--- hardware-monitor-0.7/src/curve-view.cpp	2003-10-15 15:25:04.000000000 -0700
***************
*** 48,53 ****
--- 48,56 ----
    
  private:
    std::auto_ptr<Gnome::Canvas::Line> line;
+   // GSN
+   std::auto_ptr<Gnome::Canvas::Line> gsn_line[20];
+   int gsn_nlines;
  
    // we need to store the past values
    typedef std::deque<double> value_sequence;
***************
*** 58,64 ****
  };
  
  Curve::Curve(Monitor *m, const Glib::ustring &mon_dir)
!   : monitor(m), monitor_dir(mon_dir)
  {}
  
  void Curve::update(unsigned int max_samples)
--- 61,67 ----
  };
  
  Curve::Curve(Monitor *m, const Glib::ustring &mon_dir)
!   : monitor(m), gsn_nlines(0), monitor_dir(mon_dir)
  {}
  
  void Curve::update(unsigned int max_samples)
***************
*** 114,123 ****
      client->set(monitor_dir + "/line_width", line_width);
    }
    
- 
    line->property_fill_color_rgba() = color;
    line->property_width_units() = line_width;
-   
  
    double max = std::max(monitor->max(), 0.000001); // avoid division by zero
  
--- 117,124 ----
***************
*** 138,145 ****
    } while (++vi != vend);
  
    line->property_points() = points;
- }
  
  
  //
  // class CurveView
--- 139,178 ----
    } while (++vi != vend);
  
    line->property_points() = points;
  
+   // GSN starts here
+   // make sure line is initialised
+   int gsn_lines_needed = (int) (max-0.01);
+   // need more lines than we have
+   if (gsn_nlines < gsn_lines_needed) {
+     for (int i=gsn_nlines; i<gsn_lines_needed; i++) 
+       gsn_line[i].reset(new Gnome::Canvas::Line(*canvas.root()));
+     gsn_nlines = gsn_lines_needed;
+   }
+   // have more lines than we need
+   else if (gsn_nlines > gsn_lines_needed) {
+     for (int i=gsn_nlines; i<gsn_lines_needed; i++) 
+       delete gsn_line[i].release();
+     gsn_nlines = gsn_lines_needed;
+   }
+ 
+   double gsn_y;
+   for (int i=0; i<gsn_nlines; i++) {
+     if (gsn_line[i].get() == 0) 
+       gsn_line[i].reset(new Gnome::Canvas::Line(*canvas.root()));
+ 
+     gsn_line[i]->property_fill_color_rgba() = color;
+     gsn_line[i]->property_width_units() = line_width;
+     
+     Gnome::Canvas::Points gsn_points;
+     gsn_points.reserve(values.size());
+     gsn_y = line_width/2 + (1 - ((i+1) / max)) * (height - line_width/2);
+     gsn_points.push_back(Gnome::Art::Point(0,     gsn_y));
+     gsn_points.push_back(Gnome::Art::Point(width, gsn_y));
+     gsn_line[i]->property_points() = gsn_points;
+   }
+   // GSN ends here
+ }
  
  //
  // class CurveView
Only in hardware-monitor-0.7/src: Makefile
diff --context --recursive hardware-monitor-0.7-orig/src/monitor-impls.cpp hardware-monitor-0.7/src/monitor-impls.cpp
*** hardware-monitor-0.7-orig/src/monitor-impls.cpp	2003-08-26 03:36:33.000000000 -0700
--- hardware-monitor-0.7/src/monitor-impls.cpp	2003-10-15 15:17:59.000000000 -0700
***************
*** 266,271 ****
--- 266,274 ----
    
    max_value *= max_decay;	// reduce gradually
    
+   if (max_value < 1)            // GSN: but keep at least 1
+     max_value = 1;
+   
    if (val > max_value)
      max_value = val * 1.05;
  
Only in hardware-monitor-0.7: stamp-h
